var T=Object.defineProperty;var S=(t,s,i)=>s in t?T(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i;var o=(t,s,i)=>(S(t,typeof s!="symbol"?s+"":s,i),i);const R=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function i(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(e){if(e.ep)return;e.ep=!0;const r=i(e);fetch(e.href,r)}};R();var q="/space-invaders-game/assets/rocket.12cf2db7.svg",H="/space-invaders-game/assets/monster.9e3386fc.svg";const N=document.querySelector("#scoreEl"),v=document.querySelector("#result");v.classList.add("hide");const n=document.querySelector("canvas");n.width=1024;n.height=576;const h=n.getContext("2d"),f=32.75,y=37.5;let x=0;h.fillStyle="#000000";h.fillRect(0,0,n.width,n.height);const p={over:!1,active:!0},d={left:{pressed:!1},right:{pressed:!1},space:{pressed:!1}};class D{constructor(){o(this,"position",{x:0,y:0});o(this,"height",100);o(this,"width",100);o(this,"velocity",{x:0,y:0});o(this,"rotation",0);o(this,"image",new Image);this.image.src=q,this.image.onload=()=>{this.height=this.image.height/5,this.width=this.image.width/5,this.position.x=n.width/2-this.width/2,this.position.y=n.height-this.height-10}}draw(){h.save(),h.globalAlpha=p.over?0:1,h.translate(this.position.x+this.width/2,this.position.y+this.height/2),h.rotate(this.rotation),h.translate(-this.position.x-this.width/2,-this.position.y-this.height/2),h.drawImage(this.image,this.position.x,this.position.y,this.width,this.height),h.restore()}update(){this.image&&(this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y)}shoot(s){s.push(new k({position:{x:this.position.x+this.width/2,y:this.position.y},color:"yellow",radius:4,velocity:{x:0,y:10}}))}}class k{constructor({color:s,velocity:i,position:c,radius:e}){o(this,"position");o(this,"radius");o(this,"color");o(this,"velocity");this.position=c,this.color=s,this.velocity=i,this.radius=e}draw(){h.fillStyle=this.color,h.beginPath(),h.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),h.fill(),h.closePath()}update(){this.draw(),this.position.y-=this.velocity.y}}class F{constructor({position:s,velocity:i}){o(this,"position");o(this,"velocity");o(this,"height",100);o(this,"width",100);o(this,"image",new Image);this.position=s,this.velocity=i,this.image.src=H,this.image.onload=()=>{this.height=y,this.width=f}}draw(){h.drawImage(this.image,this.position.x,this.position.y,this.width,this.height)}update(){this.image&&(this.draw(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y)}shoot(s){s.push(new k({position:{x:this.position.x+this.width/2,y:this.position.y},color:"white",radius:5,velocity:{x:0,y:-5}}))}}class G{constructor(){o(this,"position");o(this,"velocity");o(this,"height",100);o(this,"width",100);o(this,"invaders",[]);o(this,"columns");o(this,"rows");this.position={x:0,y:0},this.velocity={x:0,y:0},this.columns=Math.floor(Math.random()*10+5),this.rows=Math.floor(Math.random()*5)+2;for(let s=0;s<this.columns;s++){this.height+=y;for(let i=0;i<this.rows;i++)this.width+=f,this.invaders.push(new F({velocity:{x:5,y:0},position:{x:s*f,y:i*y}}))}}}class M{constructor({position:s,velocity:i,radius:c,opacity:e,color:r,fade:l}){o(this,"position");o(this,"velocity");o(this,"radius");o(this,"opacity");o(this,"color");o(this,"fade");this.position=s,this.velocity=i,this.radius=c,this.opacity=e||1,this.color=r||"white",this.fade=l||!0}draw(){h.save(),h.globalAlpha=this.opacity,h.fillStyle=this.color,h.beginPath(),h.arc(this.position.x,this.position.y,this.radius,0,Math.PI*2),h.fill(),h.closePath(),h.restore()}update(){this.draw(),this.position.y-=this.velocity.y,this.position.x-=this.velocity.x,this.fade&&(this.opacity?this.opacity=this.opacity-.02:this.opacity=0)}}const a=new D,u=[],m=[],w=[],g=[],I=[];for(let t=0;t<100;t++)I.push(new M({position:{x:Math.random()*n.width,y:Math.random()*n.height},velocity:{x:0,y:-3},color:"white",radius:Math.random()*2,fade:!1}));let E=0,b=0;function L(){!p.active||(requestAnimationFrame(L),h.clearRect(0,0,n.width,n.height),I.forEach(t=>{t.position.y>=n.height&&(t.position.y=0),t.update()}),a.update(),w.forEach((t,s)=>{if(t.invaders.length>0&&(t.invaders.forEach((i,c)=>{i.position.y+y>=n.height?setTimeout(()=>{t.invaders.splice(c,1)},0):(i.update(),i.velocity.y=0,(t.invaders[0].position.x+f*t.columns>=n.width||t.invaders[0].position.x<=0)&&(i.velocity.x=-i.velocity.x,i.velocity.y=y),u.forEach((e,r)=>{if(i.position.x+i.width>=e.position.x+e.radius&&i.position.x<=e.position.x-e.radius&&i.position.y+i.height>=e.position.y+e.radius&&i.position.y<=e.position.y-e.radius){for(let l=0;l<50;l++)g.push(new M({position:{x:i.position.x,y:i.position.y},velocity:{x:Math.random()*2-1,y:Math.random()*2-1},color:"red",radius:Math.random()*3,fade:!0}));setTimeout(()=>{t.invaders.splice(c,1),u.splice(r,1)},0),x+=100,N.innerHTML=x.toString()}}))}),E%100==0)){const i=Math.floor(Math.random()*t.invaders.length);t.invaders[i].shoot(m),E=0}t.invaders.length<=0&&setTimeout(()=>{w.splice(s,1)},0)}),g.forEach((t,s)=>{t.opacity<=0?setTimeout(()=>{g.splice(s,1)},0):t.update()}),u.forEach((t,s)=>{t.position.y+t.radius>=0?t.update():u.splice(s,1)}),m.forEach((t,s)=>{if(t.position.y+t.radius>=0?t.update():m.splice(s,1),a.position.x+a.width>=t.position.x+t.radius&&a.position.x<=t.position.x-t.radius&&a.position.y+a.height>=t.position.y+t.radius&&a.position.y<=t.position.y-t.radius){for(let i=0;i<50;i++)g.push(new M({position:{x:a.position.x+a.width/2,y:a.position.y+a.height/2},velocity:{x:Math.random()*2-1,y:Math.random()*2-1},color:"#b80e39",radius:Math.random()*3,fade:!0}));p.over=!0,setTimeout(()=>{A("you lose"),m.splice(s,1)},0),setTimeout(()=>{p.active=!1},3e3)}}),x>1e4&&(A("You Win!"),p.active=!1,p.over=!0),d.right.pressed&&a.position.x+a.width<=n.width?(a.velocity.x=5,a.rotation=.3):d.left.pressed&&a.position.x>=0?(a.velocity.x=-5,a.rotation=-.3):(a.velocity.x=0,a.rotation=0),(b%Math.floor(Math.random()*500+300)==0||w.length<=0)&&(w.push(new G),b=0),E++,b++)}L();function A(t){v.innerHTML=t,v.classList.remove("hide")}function O({key:t}){if(!p.over)switch(t){case"a":case"ArrowLeft":d.left.pressed=!0;break;case"d":case"ArrowRight":d.right.pressed=!0;break;case" ":d.space.pressed=!0,a.shoot(u);break}}function P({key:t}){switch(t){case"a":case"ArrowLeft":d.left.pressed=!1;break;case"d":case"ArrowRight":d.right.pressed=!1;break;case" ":d.space.pressed=!1;break}}addEventListener("keydown",O);addEventListener("keyup",P);
